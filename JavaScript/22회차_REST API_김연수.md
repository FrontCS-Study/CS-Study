[TOC]

## REST API

**REST**는 HTTP를 기반으로 클라이언트가 서버의 리소스에 접근하는 방식을 규정한 아키텍처고,   
**REST API**는 REST를 기반으로 서비스 API를 구현한 것을 의미한다.

> 🔍 **API** : 다른 소프트웨어 시스템과 통신하기 위해서 따라야하는 규칙



### REST API의 구성

REST API는 `자원, 행위, 표현`의 3가지 요소로 구성된다.

REST는 자체 표현 구조로 구성되어 REST API만으로 HTTP 요청의 내용을 이해할 수 있다.

| 구성 요소             | 내용                           | 표현 방법                 |
| --------------------- | ------------------------------ | ------------------------- |
| 자원(resource)        | 자원                           | URI(엔드 포인트)          |
| 행위(verb)            | 자원에 대한 행위               | HTTP 요청 메서드          |
| 표현(representations) | 자원에 대한 행위의 구체적 내용 | 페이로드(전송되는 데이터) |



### REST API 설계 원칙

REST에서 가장 중요한 기본적인 원칙은 두 가지다.

**① URI 는 리소스를 표현하는 데 집중**하고, **② 행위에 대한 정의는 HTTP 요청 메서드를 통해 하는 것**이 RESTful API를 설계하는 중심 규칙이다.

#### 1. URI는 리소스를 표현해야 한다.

리소스를 식별할 수 있는 이름은 동사보다는 명사를 사용한다. 따라서 이름에 get 같은 행위에 대한 표현이 들어가서는 안 된다.

```bash
# bad
GET / getTodos / 1 
GET / todos / show / 1

# good
GET / todos /1 
```

#### 2. 리소스에 대한 행위는 HTTP 요청 메서드로 표현한다.

HTTP 요청 메서드는 클라이언트가 서버에게 요청의 종류와 목적(리소스에 대한 행위)을 알리는 방법이다.   
주로 5가지 요청 메서드(GET, POST, PUT, PATCH, DELETE 등)를 사용해 CRUD를 구현한다.

따라서 리소스에 대한 행위는 HTTP 요청 메서드를 통해 표현하며 URI에 표현하지 않는다. 

```bash
# BAD 
GET / todos / delete / 1

# GOOD
DELETE / todos / 1
```



### REST API 작동 방법

1. **클라이언트가 서버에 요청**을 한다. 이 때, 서버가 이해하는 방식으로 API문서에 따라 요청 형식을 지정한 후 요청을 한다.
2. **서버가 클라이언트를 인증**하고 해당 요청을 수행할 수 있는 권한이 클라이언트에게 있는지 권한을 확인한다.
3. 서버가 요청을 수신하고 내부적으로 처리한다.
4. **서버가 클라이언트에게 응답을 반환**한다. 이 때, 응답에는 요청 성공 여부를 클라이언트에게 알려준다.
   또한, 응답에는 요청한 모든 정보도 포함된다.



## HTTP

### HTTP 메서드 종류

| HTTP 요청 메서드 |      종류      |         목적          | 페이로드(전송되는 데이터) |
| :--------------: | :------------: | :-------------------: | :-----------------------: |
|       GET        | index/retrieve | 모든/특정 리소스 취득 |             X             |
|       POST       |     create     |      리소스 생성      |             O             |
|       PUT        |    replace     | 리소스 **전체** 교체  |             O             |
|      PATCH       |     modify     | 리소스 **일부** 수정  |             O             |
|      DELETE      |     delete     | 모든/특정 리소스 삭제 |             X             |

#### 1. Get

> **리소스 조회 메서드 (Read)**

서버에 전달하고 싶은 데이터는 **쿼리 파라미터** 사용해서 데이터를 전달.  
쿼리 파라미터는 `key1=value1&key2=value2` 구조로 되어 있다.

```http
GET /members/100?username=inpa&height=200
```

쿼리스트링 외에 메시지 바디를 사용해서 데이터를 전달할 수 있지만, 서버에서 따로 구성해야 되기 때문에 지원하지 않는 곳이 많아서 권장하지 않는다. 조회할 때 POST도 사용할 수 있지만, GET 메서드는 캐싱이 가능하기에 GET을 사용하는 것이 유리하다.

#### 2. POST

> **전달한 데이터 처리/생성 요청 메서드 (Create)**

메시지 **바디(body)**를 통해 서버로 요청 데이터 전달하면 서버는 요청 데이터를 처리하여 업데이트.  
따라서, 헤더필드중 BODY의 데이터를 설명하는 **Content-Type**이라는 **헤더 필드**가 들어가고 어떤 데이터 타입인지 명시한다.

전달된 데이터로 주로 신규 리소스 등록, 프로세스 처리에 사용된다.  
만일 데이터를 GET 하는데 있어, JSON으로 조회 데이터를 넘겨야 하는 애매한 경우 POST를 사용한다.

> 🔍 **Content-Type 헤더 종류**
>
> **Content-Type: application/x-www-form-urlencoded**
> \- GET방식 처럼 Form의 내용을 HTTP 메시지 바디를 통해서 전송(key=value, 쿼리 파라미터 형식)
> \- 전송 데이터를 url encoding 처리
> \- 예) abc김 → abc%EA%B9%80
>
> **Content-Type: multipart/form-data**
> \- 파일 업로드 같은 바이너리 데이터 전송 시 사용
> \- 다른 종류의 여러 파일과 Form의 내용 함께 전송 가능. 그래서 이름이 multipart 이다.
>
> **Content-Type: application/json**
> \- TEXT, XML, JSON 데이터 전송 시 사용

> **⭐ GET과 POST 차이**
>
> - **사용목적**
>
>   GET은 서버의 리소스에서 데이터를 요청할 때, POST는 서버의 리소스를 새로 생성하거나 업데이트할 때 사용한다.  
>   DB로 따지면 GET은 SELECT 에 가깝고, POST는 Create 에 가깝다고 보면 된다.
>
> - **요청에 body 유무**
>
>   GET 은 URL 파라미터에 요청하는 데이터를 담아 보내기 때문에 HTTP 메시지에 body가 없다.  
>   POST 는 body 에 데이터를 담아 보내기 때문에 당연히 HTTP 메시지에 body가 존재한다.
>
> - **멱등성 (idempotent)**
>
>   멱등: 연산을 여러 번 적용하더라도 결과가 달라지지 않는 성질
>
>   GET은 리소스를 조회한다는 점에서 여러 번 요청하더라도 응답이 똑같을 것 이다.(멱등)   
>   POST는 리소스를 새로 생성하거나 업데이트할 때 사용되기 때문에 멱등이 아니라고 볼 수 있다.   

#### 3. PUT

> **리소스를 대체(수정)하는 메서드 (Update)**

- 만일 요청 메세지에 리소스가 있으면 덮어쓰고, 없으면 새로 생성한다.
  - `/members/100` 데이터가 존재하면 기존에 것을 완전 대체 한다.
  - `/members/100` 데이터가 없으면 대체 할게 없으니까 새로 생성한다.

- 데이터를 대체해야 하니, 클라이언트가 리소스의 구체적인 전체 경로를 지정해 보내주어야 한다.
  - `POST /members` : 멤버 새로 추가
  - `PUT /members/100` : 100번째 멤버 수정

> ❗ **PUT 요청에 일부 리소스만 변경하길 원할경우**
>
>  member정보에 {username, age}가 있을 때, 100번째 멤버에 age만 50으로 변경하려고 해당 데이터를 PUT으로 전달하게 된다면,  기존 데이터가 완전히 대체되어 이름 데이터가 삭제된다. **이때는 PATCH 메소드를 이용해야 한다**

#### 4. PATCH

> **리소스 일부 부분을 변경하는 메소드** **(Update)**

만일 PATCH를 지원하지 않는 서버에서는 대신에 POST를 사용할 수 있다.

#### 5. DELETE

> **리소스 제거하는 메소드 (Delete)**

상태코드는 대부분 200을 사용하고 상황에 따라 204를 사용한다.





### HTTP 상태 코드

- **1XX: Informational(정보 제공)**
  - 임시 응답으로 현재 클라이언트의 요청까지는 처리되었으니 계속 진행하라는 의미
  - 서버측에서 클라이언트의 요청을 받았으며 작업을 계속 진행하고 있다는 의미

- **2XX: Success(성공)**

  - 클라이언트의 요청이 서버에서 성공적으로 처리되었다는 의미

  | 상태 코드 | 코드 명 | 의미                                                    |
  | --------- | ------- | ------------------------------------------------------- |
  | 200       | OK      | 요청이 성공적으로 보내졌음을 의미                       |
  | 201       | Created | 요청이 성공적이였으며 새로운 리소스가 생성되었음을 의미 |

- **3XX: Redirection(리다이렉션)**

  - 완전한 처리를 위해서 추가 동작이 필요한 경우입니다.

- **4XX: Client Error(클라이언트 에러)**

  - 없는 페이지를 요청하는 등 클라이언트의 요청에 오류가 있는 경우를 의미

  | 상태 코드 | 코드 명     | 의미                                                         |
  | --------- | ----------- | ------------------------------------------------------------ |
  | 400       | Bad Request | 요청의 구문이 잘못됨.<br />잘못된 문법으로 인하여 서버가 요청을 이해할 수 없음을 의미 |
  | 401       | Unathorized | 비인증(Unathorize)된 요청임을 의미                           |
  | 403       | Forbidden   | 콘텐츠에 접근할 권한을 가지고 있지 않음을 의미               |
  | 404       | Not Found   | 요청받은 리소스를 찾을 수 없음을 의미                        |

  > **💡 401과 403의 차이**
  >
  > - 401(Unauthorized)
  >   - 상태: 클라이언트가 인증되지 않았거나, 유효한 인증 정보가 부족하여 요청이 거부됨
  >   - 예시: 사용자가 로그인되지 않은 경우
  > - 403(Forbidden)
  >   - 상태: 서버가 해당 요청을 이해했지만, 권한이 없어 요청이 거부됨
  >   - 예시: 사용자가 다른 사용자의 데이터 조회 요청을 하는 경우 (= 권한이 없는 요청의 경우)

- **5XX: Server Error(서버 에러)**

  - 클라이언트의 요청은 유효한데 서버가 처리에 실패한 경우
    서버의 부하, DB 처리 과정 오류, 서버에서 익셉션이 발생하는 경우를 의미

  | 상태 코드 | 코드 명               | 의미                                                        |
  | --------- | --------------------- | ----------------------------------------------------------- |
  | 500       | Internal Server Error | 서버가 처리 방법을 모르는 상황을 의미(서버에서 에러 발생시) |
  | 501       | Not Implemented       | 요청한 URI의 메소드에 대해 서버가 구현하고 있지 않다.       |



---

**참고**

[[자바스크립트 딥다이브] 44장 REST API](https://velog.io/@boram_in/%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8-%EB%94%A5%EB%8B%A4%EC%9D%B4%EB%B8%8C-44%EC%9E%A5-REST-API)

[[모던 자바스크립트] 5.36 REST API | PoiemaWeb](https://poiemaweb.com/js-rest-api)

[HTTP 메서드 종류 & 요청 흐름 총정리 - Inpa Dev ‍ - 티스토리](https://inpa.tistory.com/entry/WEB-🌐-HTTP-메서드-종류-통신-과정-💯-총정리)

[[네트워크] get 과 post 의 차이](https://noahlogs.tistory.com/35)

[RESTful API에 대한 이해](https://velog.io/@goldbear2022/RESTful-API%EC%97%90-%EB%8C%80%ED%95%9C-%EC%9D%B4%ED%95%B4)

[[웹 프로그래밍] HTTP 상태 코드 표(100 ~ 500) 전체 요약 정리](https://hongong.hanbit.co.kr/http-상태-코드-표-1xx-5xx-전체-요약-정리)

[[HTTP] HTTP 상태 401(Unauthorized) vs 403(Forbidden) 차이](https://mangkyu.tistory.com/146)
